shiny::runApp()
runApp()
runApp()
setwd("D:/projects/Venkata/shiny_lease")
rm( list = ls() ) ; options( scipen = 999 )
library( shiny ) ; library( shinydashboard ) ; library( dplyr ) ; library( data.table )
library( shinyWidgets ) ; library( DT ) ; library( plotly ) ; library( bsts )
source( 'global_functions.R' )
if( !file.exists( 'my_asset_class_df_stored.csv' ) ){
my_asset_class_stored = data.frame()
} else{
my_asset_class_stored = fread( 'my_asset_class_df_stored.csv' )
}
if( !file.exists( 'my_lease_df_stored.csv' ) ){
my_lease_df_stored = data.frame()
} else{
my_lease_df_stored = fread( 'my_lease_df_stored.csv' )
}
my_cashflow_df_stored = Generate_Cash_Flows( tail( my_lease_df_stored, 1 ) )
lease_df_input = tail( my_lease_df_stored, 1 )
lease_payment_freq = switch( tolower( lease_df_input$`Lease.Payment.Frequency` ),
'monthly' = 'month', 'quarterly' = 'quarter', 'half_yearly' = '6 months', 'yearly' = 'year'
)
cashflow_df = data.table( LeaseId = lease_df_input$`Lease.ID`,
Date = seq.Date( as.Date( lease_df_input$`Rent.Effective.Date`, format="%d-%m-%Y" ),
as.Date( lease_df_input$`End.Date`, format="%d-%m-%Y" ), lease_payment_freq ), Type = 'Rent' ) %>% mutate(
'Lease_Rental' = lease_df_input$Rent*( ( 1 + lease_df_input$`Escalation.Percent`/100 )^( as.integer( ( Date - as.Date( lease_df_input$`Rent.Effective.Date`, format="%d-%m-%Y" ) ) )%/%365 ) ),
'Upfront_Cost' = 0 ) %>% as.data.frame()
View( cashflow_df )
12%/%lease_df_input$Escalation.Tenure
lease_df_input$Escalation.Tenure
cashflow_df = data.table( LeaseId = lease_df_input$`Lease.ID`,
Date = seq.Date( as.Date( lease_df_input$`Rent.Effective.Date`, format="%d-%m-%Y" ),
as.Date( lease_df_input$`End.Date`, format="%d-%m-%Y" ), lease_payment_freq ), Type = 'Rent' ) %>% mutate(
#        'Lease_Rental' = lease_df_input$Rent*( ( 1 + lease_df_input$`Escalation.Percent`/100 )^( as.integer( ( Date - as.Date( lease_df_input$`Rent.Effective.Date`, format="%d-%m-%Y" ) ) )%/%365 ) ),
'Lease_Rental' = lease_df_input$Rent*( ( 1 + lease_df_input$`Escalation.Percent`/100 )^( as.integer( ( Date - as.Date( lease_df_input$`Rent.Effective.Date`, format="%d-%m-%Y" ) ) )%/%( 30*lease_df_input$Escalation.Tenure ) ) ),
'Upfront_Cost' = 0 ) %>% as.data.frame()
